jQuery(function(e){function c(e,c){return!e.attr("disabled")&&("click"===c.type||13===c.which)}function t(c){c?(e("#cm-create").removeAttr("disabled"),e("#cm-cancel").removeAttr("disabled")):(e("#cm-create").attr("disabled","disabled"),e("#cm-cancel").attr("disabled","disabled"))}function n(c,t){return t&&c.val(e.trim(c.val())),""==c.val().replace(/^\s+/,"")?!1:!0}function a(t){"undefined"!=typeof t.success?(t.success?(e("#cm-ctheme").append(e("#cm-cname").val()),e("#cm-preview").attr("href",e("#cm-preview").attr("href")+t.data.stylesheet)):i(t.data.message),s(),e("#cm-success").css("display","block")):t.indexOf("<form")>-1?(o(),e("#cm-form-container").append('<div id="ftp-form">'+t+"</div>"),d("#ftp-form"),e('input[name="hostname"]').focus(),e("#childify-container input#upgrade").on("keydown click",function(t){t.preventDefault(),c(e(this),t)&&(e(this).attr("disabled","disabled"),r())})):(s(),i(t),e("#cm-success").css("display","block"))}function i(c){e("#cm-success > p").text(c?c:"Error"),e("#cm-success").removeClass("updated"),e("#cm-success").addClass("error"),e("#cm-success #cm-preview").detach()}function r(){y+="&"+e("#childify-container form").serialize(),e.post(h,y,function(e){a(e)})}function s(){e("#cm-form-container").detach(),e("#cm-add-new").detach(),e("#cm-info").detach()}function o(){e("#ftp-form").length>0&&e("#ftp-form").detach()}function d(c){var t=parseInt(e(c).offset().top)-parseInt(e(".wp-full-overlay-sidebar-content").offset().top)+parseInt(e(".wp-full-overlay-sidebar-content").scrollTop());e(".wp-full-overlay-sidebar-content").animate({scrollTop:t},700)}var m=e("#customize-info").parent(),l=_.template(e("script#childify-tpl").html()),f="action="+CMAdmin.Action,p="CMnonce="+CMAdmin.CMnonce,u="parent="+CMAdmin.Parent,y=f+"&"+p+"&"+u,h=CMAdmin.AjaxUrl;m.append(l()),e("#cm-add-new").on("keypress click",function(t){c(e(this),t)&&(e(this).toggleClass("open"),e("#cm-form-container").slideToggle("fast"),e("#cm-cname").attr("readonly")||(e("#cm-cname").focus(),d(e("#cm-cname"))))}),e("#cm-cancel").on("keypress click",function(a){c(e(this),a)&&(e("#cm-cname").removeAttr("readonly"),e("#cm-create").removeAttr("disabled"),e("#cm-cname").val(""),o(),t(n(e("#cm-cname"))))}),e("#cm-create").on("keypress click",function(t){c(e(this),t)&&n(e("#cm-cname"),!0)&&(e(this).attr("disabled","disabled"),e("#cm-cname").attr("readonly","readonly"),r())}),e("#cm-cname").on("keyup blur",function(c){if(!e(this).attr("readonly")){if(c.keyCode){if(c.keyCode>34&&c.keyCode<41||16==c.keyCode)return;if(13==c.keyCode)return void e("#cm-create").trigger("click")}t(n(e(this)))}}),e(document).ready(function(e){t(!1),e("#childify-container").css("display","block")})});
